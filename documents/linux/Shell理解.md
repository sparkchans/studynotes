## Linux Shell 的理解

Shell 不单单是一种CLI。它是一个时刻都在运行的复杂交互程序。

### Shell 的类型

系统启动的 shell 程序类型在 /etc/passwd 文件中，在用户 ID 记录的第7个字段中列出了默认的shell程序。

### Shell 的父子关系

在 Shell 中输入 /bin/shell 这个命令后，会生成一个子 shell 运行。在生成子 shell 进程时，只有部分父进程的环境被复制到子 shell 环境中。

### 进程列表

在执行命令时将命令包含在括号里，就会生成一个子 shell 来执行对应的命令。可以通过查看环境变量 $BASH_SUBSHELL 来判断是否有子 shell 生成。如果该环境变量是 1  或者更大的数字，就表明存在子 shell。

在交互式 shell 中，一个高效的子 shell 用法就是使用后台模式。在后台模式中运行命令可以在处理命令的同时让出 CLI。也就是说，对于后台模式执行的命令，shell 不会等待它执行结束。使用 & 符号就可以让命令进入后台模式运行。在 CLI 中运用子 shell 的创造性方法之已就是将进程列表置于后台模式。你既可以在子 shell 中进行繁重的处理工作，同时也不会让子 shell 的 I/O 受制于终端。

### Shell 的内建命令

外部命令被称为文件系统命令，是存在于 bash shell 之外的程序。他们并不是程序的一部分。当外部命令执行是，会创建一个子进程。外部命令通常位于 /bin、/usr/bin 、/sbin/或/usr/sbin中。可以通过 which 和 type 命令找到它。

内建命令已经和 shell 编译成了一体，作为 shell 工具的组成部分存在。cd 和 exit 命令都内建于 bash shell。通过在命令行中输入 !! 可以唤起刚刚使用过的那条命令来使用。

- history 命令

  history 命令可以查看最近使用过的命令列表。命令历史记录被保存在隐藏的.bash_history中，bash 命令的历史记录是先放在内存中的，当 shell 退出时才被写入到历史文件中。可以使用 history -a 命令强制写入。.bash_history 文件只有在打开首个终端会话时才被读取，可以使用 history -n 命令强制重新读取。

- alias 命令

  alias -p 查看已设置的命令别名。使用 alias li='ls -li' 可以创建属于自己的别名。

### 问题

命令后台执行原理是什么？

子 shell 和后台执行的区别？